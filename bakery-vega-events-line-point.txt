{


  $schema: https://vega.github.io/schema/vega-lite/v2.json
  title: Event counts from all indexes

  // Define the data source
  data: {
    url: {

      %context%: true

      %timefield%:  transaction_dt

      // Which index to search
      index: _all

      body: {
        aggs: {
          time_buckets: {
            date_histogram: {

              field:  transaction_dt

              interval: {%autointerval%: true}

              extended_bounds: {
                // Use the current time range's start and end
                min: {%timefilter%: "min"}
                max: {%timefilter%: "max"}
              }

              min_doc_count: 0
            }
          }
        }
        // Speed up the response by only including aggregation results
        size: 0
      }
    }

    format: {property: "aggregations.time_buckets.buckets"}
  }

  mark:  {
    type : line
    color : green
    point : {
      color : red
    }
  }

  encoding: {
    x: {

      field: key
      type: temporal
      axis: {title: false} // Customize X axis format
    }
    y: {

      field: doc_count
      type: quantitative
      axis: {title: "Document count"}
    }
  }
}

